---
title: nanobot核心特性
date: 2026-02-19 10:00:00 +0800
categories: [LLM, Agent]
tags: [nanobot, agent]
pin: true
---


# 核心特性

持续研究中。 

## Channels 和 MessageBus
本质 N chat apps 集成。 


```
  Telegram ──┐                                  ┌── Telegram
  Discord  ──┼──▶ [inbound Queue] ──▶ Agent ──▶ [outbound Queue] ──▶ Discord
  WhatsApp ──┘    (多写一读)                      (一写多读)         └── WhatsApp
```


## AgentLoop
```
ReAct 

┌─────────────────────────────────────────────────────────────┐
│                    AgentLoop 状态机                           │
│                                                              │
│   ┌──────────┐    has_tool_calls=true    ┌──────────┐       │
│   │          │ ──────────────────────▶  │          │       │
│   │ Reasoning│                          │  Acting  │       │
│   │ (LLM推理)│  ◀──────────────────────  │ (执行工具)│       │
│   │          │    tool_result 追加到     │          │       │
│   └────┬─────┘    messages 再回来推理    └──────────┘       │
│        │                                                     │
│        │ has_tool_calls=false                                │
│        ▼                                                     │
│   ┌──────────┐                                               │
│   │ 输出回答  │  ← LLM 认为不需要再调工具了，直接回答        │
│   │  break   │                                               │
│   └──────────┘                                               │
└─────────────────────────────────────────────────────────────┘
```
```
              ┌──────────┐
              │  LLM 推理 │ ◄── messages (system + history + user + tool results)
              └────┬─────┘
                   │
          ┌────────┴────────┐
          │ has_tool_calls? │
          └──┬──────────┬───┘
           Yes          No
          ┌──▼──┐    ┌──▼──┐
          │执行  │    │输出  │
          │Tools │    │回答  │
          └──┬──┘    └─────┘
             │
             └──► 将 tool result 追加到 messages → 回到 LLM 推理
```
 max_iterations: int = 20. 

 Skills 本质也是prompt的。 不过metadata 2级，减少context tokens. 
    先给摘要，Agent 按需用 read_file 加载。 

## Provider
 
默认 调用 LiteLLM sdk. 源码只放了 一个 LiteLLMProvider.

## Tools 

十个内置 Tool:

```python
 # 文件系统（4 个）
    self.tools.register(ReadFileTool(allowed_dir=allowed_dir))
    self.tools.register(WriteFileTool(allowed_dir=allowed_dir))
    self.tools.register(EditFileTool(allowed_dir=allowed_dir))
    self.tools.register(ListDirTool(allowed_dir=allowed_dir))

    # Shell（1 个）
    self.tools.register(ExecTool(working_dir=str(self.workspace), timeout=60))

    # Web（2 个）
    self.tools.register(WebSearchTool(api_key=self.brave_api_key))
    self.tools.register(WebFetchTool())

    # 通信（1 个）
    message_tool = MessageTool(send_callback=self.bus.publish_outbound)
    self.tools.register(message_tool)

    # 子代理（1 个）
    spawn_tool = SpawnTool(manager=self.subagents)
    self.tools.register(spawn_tool)

    # 定时任务（1 个，可选）
    if self.cron_service:
        self.tools.register(CronTool(self.cron_service))
```

Shell 安全防护：正则黑名单
workspace 路径限制.

subagent  能力裁剪， 隔离。 

## 记忆

MEMORY.md 长期
`memory/YYYY-MM-DD.md` 按日归档

本质 bot是单机特征，"Markdown as Database"的方式足够高效且极其可调试。 

## Sandbox
裸机物理隔离。 云端沙盒 可用Firecracker组织，或者E2B。 





